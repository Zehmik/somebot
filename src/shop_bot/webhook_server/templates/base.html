<!DOCTYPE html>
<html lang="ru">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>{% block title %}Панель управления Ботом{% endblock %}</title>
		<link
			rel="stylesheet"
			href="{{ url_for('static', filename='css/style.css') }}"
		/>
		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	</head>
	<body>
		<div class="container">
			<header class="main-header">
				<nav class="navigation">
					<a
						href="{{ url_for('dashboard_page') }}"
						class="nav-link {% if request.endpoint == 'dashboard_page' %}active{% endif %}"
						>Dashboard</a
					>
					<a
						href="{{ url_for('users_page') }}"
						class="nav-link {% if request.endpoint == 'users_page' %}active{% endif %}"
						>Пользователи</a
					>
					<a
						href="{{ url_for('settings_page') }}"
						class="nav-link {% if request.endpoint == 'settings_page' %}active{% endif %}"
						>Настройки</a
					>
				</nav>

				<div class="header-controls">
					<div class="bot-control">
						{% if bot_status.shop_bot_running %}
						<p class="status-running">Shop: <strong>Запущен</strong></p>
						<form action="{{ url_for('stop_shop_bot_route') }}" method="post">
							<button type="submit" class="button button-stop button-small">
								Остановить
							</button>
						</form>
						{% else %}
						<p class="status-stopped">Shop: <strong>Остановлен</strong></p>
						{% if all_settings_ok %}
						<form action="{{ url_for('start_shop_bot_route') }}" method="post">
							<button type="submit" class="button button-start button-small">
								Запустить
							</button>
						</form>
						{% else %}
						<button
							class="button button-disabled button-small"
							disabled
							title="Заполните обязательные настройки Telegram"
						>
							Запустить
						</button>
						{% endif %} {% endif %}
					</div>

					<div class="bot-control">
						{% if bot_status.support_bot_running %}
						<p class="status-running">Support: <strong>Запущен</strong></p>
						<form
							action="{{ url_for('stop_support_bot_route') }}"
							method="post"
						>
							<button type="submit" class="button button-stop button-small">
								Остановить
							</button>
						</form>
						{% else %}
						<p class="status-stopped">Support: <strong>Остановлен</strong></p>
						<form
							action="{{ url_for('start_support_bot_route') }}"
							method="post"
						>
							<button type="submit" class="button button-start button-small">
								Запустить
							</button>
						</form>
						{% endif %}
					</div>

					<div class="user-session-controls">
						<span>Вы вошли в систему.</span>
						<form
							action="{{ url_for('logout_page') }}"
							method="post"
							style="display: inline"
						>
							<button type="submit" class="button button-logout">Выйти</button>
						</form>
					</div>
				</div>
			</header>

			{% with messages = get_flashed_messages(with_categories=true) %} {% if
			messages %} {% for category, message in messages %}
			<div class="flash flash-{{ category }}">{{ message }}</div>
			{% endfor %} {% endif %} {% endwith %}

			<main>{% block content %}{% endblock %}</main>
		</div>
		<script src="{{ url_for('static', filename='js/script.js') }}"></script>
	</body>
</html>
